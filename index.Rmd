---
title: "Rice Production"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

---

```{r lib}
library(ezids)
```

```{r pi}
#load the dataset
rice_prod <- read.csv("C:/Users/HARI/Documents/DATS6101-Team4/Rice Production Data.csv")

#display top six rows of the dataset
head(rice_prod)

xkabledplyhead(rice_prod, title = "Rice Production")
```

```{r}
#get the shape of dataset
dim(rice_prod)
```

```{r col}
#get the column names of dataset
colnames(rice_prod)
```

```{r modify}

#defining name_map to rename the columns
name_map <- c(
  "Production..t." = "Production",
  "production__tonnes__per_capita" = "Production_per_capita(kg)",
  "Production.per.capita..kg." = "Production_per_capita(kg)",
  "Yield..t.ha." = "Yield(t/ha)",
  "Land.Use..ha." = "Land_Use",
  "area_harvested__ha__per_capita" = "Area_Harvested(ha_per_capita)",
  "Land.Use.per.capita..m.." = "Land_Use_per_Capita",
  "Imports..t." = "Imports(t)",
  "imports__tonnes__per_capita" = "Imports(t_per_capita)",
  "Imports.per.capita..kg." = "Imports_per_capita(kg)",
  "Exports..t." = "Exports(t)",
  "exports__tonnes__per_capita" = "Exports(t_per_capita)",
  "Exports.per.capita..kg." = "Exports_per_capita(kg)",
  "Domestic.supply..t." = "Domestic_Supply(t)",
  "domestic_supply__tonnes__per_capita" = "Domestic_Supply(t_per_capita)",
  "Domestic.supply.per.capita..kg." = "Domestic_Supply_per_Capita(kg)",
  "Food..t." = "Food(t)",
  "food__tonnes__per_capita" = "Food(t_per_capita)",
  "Food.per.capita..kg." = "Food_per_Capita(kg)",
  "Animal.feed..t." = "Animal_Feed(t)",
  "feed__tonnes__per_capita" = "Animal_Feed(t_per_capita)",
  "Animal.feed.per.capita..kg." = "Animal_Feed_per_Capita(kg)",
  "Other.uses..t." = "Other_Uses(t)",
  "other_uses__tonnes__per_capita" = "Other_Uses(t_per_capita)",
  "Other.uses.per.capita..kg." = "Other_uses_per_capita(kg)",
  "Supply.chain.waste..t." = "Supply_Chain_Waste(t)",
  "waste_in_supply_chain__tonnes__per_capita" = "Waste_in_supply_chain(t_per_capita)",
  "Supply.chain.waste.per.capita..kg." = "Supply_chain_waste_per_Capita(kg)",
  "Food.supply..kg.per.capita.per.year." = "Food_supply(kg_per_capita_per_day)",
  "Food.supply..g.per.capita.per.day." = "Food_supply(g_per_capita_per_day)",
  "Food.supply..kcal.per.capita.per.day." = "Food_supply(kcal_per_capita_per_day)",
  "Food.supply..Protein.g.per.capita.per.day." = "Food_supply(Protein_per_capita_per_day)",
  "Food.supply..Fat.g.per.capita.per.day." = "Food_supply(Fat_per_capita_per_day)"
)

#rename the columns based on name_map
for (old_name in colnames(rice_prod)) {
  if (old_name %in% names(name_map)) {
    colnames(rice_prod)[colnames(rice_prod) == old_name] <- name_map[old_name]
  }
}

#displaying the changed column names
colnames(rice_prod)
```
```{r}
#hari
# Load necessary libraries
library(dplyr)
library(ggplot2)
library(zoo)

columns_of_interest <- 
  c("Country","Year","Production","Population","Land_Use")

df_filtered <- rice_prod %>%
  select(columns_of_interest)

df_filtered <- df_filtered[df_filtered$Year >= 1980 & df_filtered$Year <= 2020, ]

dim(df_filtered)

#to check the number of missing values for each column
no_of_na = missing_values <- colSums(is.na(df_filtered))
no_of_na

#removing countries for which all values are NA
df_cleaned <- df_filtered %>%
  group_by(Country) %>%
  filter(any(!is.na(Land_Use))) %>%
  ungroup()

#removing countries for which all values are 0
df_cleaned <- df_cleaned %>%
  group_by(Country) %>%
  filter(any(Land_Use > 0)) %>%
  ungroup() 

dim(df_cleaned)
```
```{r}

ggplot(df_cleaned, aes(Population)) +
  geom_histogram(color = "#000000", fill = "#0099F8") +
    labs(title = "Histogram of Population",
       x = "Population",
       y = "Count")

# Mean imputation using na.approx
#df_cleaned["Population"] <- na.approx(df_cleaned["Population"])
```
```{r}

ggplot(df_cleaned, aes(x = Year, y = Population)) +
  geom_line(color = "blue", size = 0.5) +  # Adjust line color and size
  geom_point(color = "red", size = 1, alpha = 0.7) +
  labs(title = "Population Over Time", x = "Year", y = "Population") +
  theme_minimal() +  # Use a minimal theme
  labs(title = "Time Series with Linear Imputation",  # Add title
       x = "Time",  # Label for x-axis
       y = "Values")  # Label for y-axis

#Population over time for each country
ggplot(df_cleaned, aes(x = Year, y = Population, color = Country)) +
  geom_line(alpha=0.7, size=1) +
  labs(title = "Population Over Time by Country", x = "Year", y = "Population")+ theme_minimal() +
  theme(legend.position = "none")

#total population by year
total_population <- df_cleaned %>%
  group_by(Year) %>%
  summarise(total_population = sum(Population))

ggplot(total_population, aes(x = Year, y = total_population)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(title = "Total Population by Year", x = "Year", y = "Total Population") +
  theme_minimal()

#population distribution
ggplot(df_cleaned, aes(x = Population)) +
  geom_histogram(bins = 30, fill = "lightblue", color = "black") +
  labs(title = "Distribution of Population", x = "Population", y = "Frequency") +
  theme_minimal()


```
```{r}
df_imputed <- df_cleaned %>%
  group_by(Country) %>%
  mutate(Population = na.approx(Population, na.rm = FALSE))
```
